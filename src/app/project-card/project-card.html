<div
  class="mb-6 rounded-2xl p-6
         bg-white/70 backdrop-blur border border-white/60 ring-1 ring-slate-200/60
         shadow-sm hover:shadow-xl hover:-translate-y-0.5 transition
         dark:bg-slate-900/50 dark:border-slate-700/40 dark:ring-slate-700/50"
>
  <!-- Header -->
  <div class="flex items-start justify-between gap-4 mb-4">
    <div class="flex-1">
      <h2 class="text-xl font-extrabold text-slate-900 dark:text-white mb-1">
        {{ project.name }}
      </h2>
      <p class="text-slate-600 dark:text-slate-300 text-sm leading-relaxed mt-3">
        {{ project.description }}
      </p>
    </div>

    <div class="flex flex-col items-end gap-2">
      <button
        (click)="toggleEditProjectForm()"
        type="button"
        class="inline-flex items-center justify-center rounded-full px-3 py-1 text-sm font-semibold
               bg-indigo-600/10 text-indigo-700 border border-indigo-500/20
               hover:bg-indigo-600/15
               dark:bg-indigo-400/10 dark:text-indigo-200 dark:border-indigo-400/20
               transition"
        title="Modifier le projet"
      >
        Modifier
      </button>

      <span
        class="px-3 py-1 text-xs font-semibold rounded-full border"
        [ngClass]="{
          'bg-emerald-500/10 text-emerald-700 border-emerald-500/20 dark:bg-emerald-400/10 dark:text-emerald-200 dark:border-emerald-400/20': project.status === 'Terminé',
          'bg-amber-500/10 text-amber-700 border-amber-500/20 dark:bg-amber-400/10 dark:text-amber-200 dark:border-amber-400/20': project.status === 'En cours',
          'bg-slate-500/10 text-slate-700 border-slate-500/20 dark:bg-slate-400/10 dark:text-slate-200 dark:border-slate-400/20': project.status !== 'Terminé' && project.status !== 'En cours'
        }"
      >
        {{ project.status }}
      </span>
    </div>
  </div>

  <!-- Progress -->
  <div class="mb-4">
    <div class="flex justify-between items-center text-sm text-slate-600 dark:text-slate-300 mb-2">
      <span class="font-semibold">Progression</span>
      <span class="font-bold text-slate-900 dark:text-white">{{ getProjectProgress(project) }}%</span>
    </div>
    @let p = getProjectProgress(project);

    <div class="w-full rounded-full h-3 overflow-hidden bg-slate-200 dark:bg-slate-700">
      <div
        class="h-3 rounded-full transition-all duration-300 bg-gradient-to-r"
        [style.width.%]="p"
        [class.from-rose-500]="p < 40"
        [class.to-fuchsia-500]="p < 40"
        [class.from-amber-500]="p >= 40 && p < 80"
        [class.to-orange-500]="p >= 40 && p < 80"
        [class.from-emerald-500]="p >= 80"
        [class.to-cyan-500]="p >= 80"
      ></div>
    </div>
    
    
  </div>

  @if (showEditProjectForm) {
    <app-edit-project
      [project]="project"
      (projectUpdated)="updateProject($event)"
      (cancel)="toggleEditProjectForm()"
    ></app-edit-project>
  }

  @if (showAddTaskForm || showEditTaskForm) {
    <app-add-task
      [taskToEdit]="taskToEdit"
      [isEditMode]="showEditTaskForm"
      (taskAdded)="addTask($event)"
      (taskUpdated)="updateTask($event)"
      (cancel)="closeTaskForm()"
    ></app-add-task>
  }

  <app-task-list
    [tasks]="project.tasks"
    (addTaskClick)="toggleAddTaskForm()"
    (editTaskClick)="openEditTaskForm($event)"
  ></app-task-list>
</div>
